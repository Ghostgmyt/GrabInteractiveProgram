#include <iostream>
#include <cmath>    // for round
using namespace std;

int main() {
    cout << "=== GRAB Fare & ETA Estimator (Student Version) ===\n";

    // ---------- PRESET INPUTS (edit these before Run) ----------
    double distance = 6.0;  // km [0.5..100]
    int hour        = 18;   // 0..23
    int demand      = 9;    // 1..10
    int supply      = 3;    // 1..10
    int tier        = 2;    // 1=Basic, 2=Silver, 3=Gold
    int service     = 1;    // 1=Standard, 2=Pool
    int toll        = 2;    // flat RM toll fee to add

    // ---------- "Questions" and answers ----------
    cout << "Enter trip distance in km (0.5 - 100): " << distance << "\n";
    cout << "Enter the hour of the day (0 - 23): " << hour << "\n";
    cout << "On a scale of 1 to 10, how high is the demand? " << demand << "\n";
    cout << "On a scale of 1 to 10, how many drivers (supply) are available? " << supply << "\n";
    cout << "Choose your tier (1 = Basic, 2 = Silver, 3 = Gold): " << tier << "\n";
    cout << "Choose service type (1 = Standard, 2 = Pool): " << service << "\n";
    cout << "Enter toll charges (RM): " << toll << "\n";

    // ---------- Basic validation ----------
    if (distance < 0.5) distance = 0.5;
    if (distance > 100.0) distance = 100.0;
    if (hour < 0) hour = 0; if (hour > 23) hour = 23;
    if (demand < 1) demand = 1; if (demand > 10) demand = 10;
    if (supply <= 0) supply = 1; if (supply > 10) supply = 10;
    if (tier < 1) tier = 1; if (tier > 3) tier = 3;
    if (service < 1) service = 1; if (service > 2) service = 2;
    if (toll < 0) toll = 0;

    // ---------- Logic ----------
    // rates
    double base, perKm, perMin;
    if (service == 1) { base = 3.0; perKm = 1.5; perMin = 0.3; } // Standard
    else              { base = 2.0; perKm = 1.0; perMin = 0.2; } // Pool

    // ETA (minutes) with slower speed at peaks
    double speed = 32.0;
    if ((hour >= 7 && hour <= 9) || (hour >= 17 && hour <= 20)) speed = 22.0;
    double eta = (distance / speed) * 60.0;
    if (eta < 5.0) eta = 5.0;

    // surge
    double ratio = (double)demand / (double)supply;
    double surge = 1.0;
    if (ratio > 1.0) surge += (ratio - 1.0);
    if ((hour >= 7 && hour <= 9) || (hour >= 17 && hour <= 20)) surge += 0.25;
    if (surge > 3.5) surge = 3.5;

    // tier discount
    double disc = 0.0;
    if (tier == 2) disc = 0.07;
    else if (tier == 3) disc = 0.15;

    // fare calculation
    double subtotal = (base + perKm * distance + perMin * eta) * surge;
    double discounted = subtotal * (1.0 - disc);
    double total = discounted + toll;

    // round to nearest whole number
    int finalFare = (int)round(total);

    // ---------- Output ----------
    cout << "\n--- Fare Result ---\n";
    cout << "Service       : " << (service == 1 ? "Standard" : "Pool") << "\n";
    cout << "Distance (km) : " << distance << "\n";
    cout << "ETA (minutes) : " << (int)round(eta) << "\n";
    cout << "Surge         : x" << surge << "\n";
    cout << "Tier Discount : " << (int)(disc*100) << "%\n";
    cout << "Toll Charges  : RM " << toll << "\n";
    cout << "Estimated Fare: RM " << finalFare << "\n";

    // tip
    if (surge >= 2.0 && distance <= 8.0 && service == 1) {
        cout << "Tip: POOL may be cheaper now due to high surge on a short trip.\n";
    } else if (service == 2) {
        cout << "Note: STANDARD may be faster if youâ€™re in a hurry.\n";
    }

    return 0;
}
